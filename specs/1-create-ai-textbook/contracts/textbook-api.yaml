# Textbook API Contract

**Feature**: AI-Native Textbook using Docusaurus
**Date**: 2025-01-07
**Version**: 1.0.0

## Overview

This document defines the API contracts for the AI-Native Textbook system. The primary purpose is to enable the RAG (Retrieval-Augmented Generation) chatbot to access and retrieve content from the textbook.

## Base URL

```
https://[textbook-domain]/api/v1
```

## Content Retrieval Endpoints

### Get All Chapters

**GET** `/chapters`

Retrieve a list of all textbook chapters.

#### Response

```json
{
  "chapters": [
    {
      "id": "chapter-01-introduction",
      "number": 1,
      "title": "Introduction to Physical AI",
      "description": "Build foundational understanding of embodied intelligence",
      "lessonCount": 4,
      "url": "/docs/chapter-01-introduction"
    }
  ]
}
```

### Get Chapter Content

**GET** `/chapters/{chapterId}`

Retrieve a specific chapter and its lessons.

#### Path Parameters

- `chapterId` (string): The unique identifier of the chapter

#### Response

```json
{
  "id": "chapter-01-introduction",
  "number": 1,
  "title": "Introduction to Physical AI",
  "description": "Build foundational understanding of embodied intelligence",
  "lessons": [
    {
      "id": "lesson-1-what-is-physical-ai",
      "number": 1,
      "title": "What is Physical AI?",
      "url": "/docs/chapter-01-introduction/lesson-1-what-is-physical-ai"
    }
  ]
}
```

### Get Lesson Content

**GET** `/lessons/{lessonId}`

Retrieve the content of a specific lesson.

#### Path Parameters

- `lessonId` (string): The unique identifier of the lesson

#### Response

```json
{
  "id": "lesson-1-what-is-physical-ai",
  "chapterId": "chapter-01-introduction",
  "number": 1,
  "title": "What is Physical AI?",
  "learningObjectives": [
    "Define Physical AI",
    "Understand the difference from digital AI",
    "Identify applications of Physical AI"
  ],
  "content": "# What is Physical AI?\n\nPhysical AI refers to the field that combines artificial intelligence...",
  "examples": [
    "Example of Physical AI in manufacturing"
  ],
  "keyTakeaways": [
    "Physical AI operates in the real world",
    "It requires embodiment to interact with the environment"
  ]
}
```

### Search Content

**POST** `/search`

Search textbook content based on a query, optimized for the RAG system.

#### Request Body

```json
{
  "query": "What is ROS 2?",
  "maxResults": 5,
  "includeMetadata": true
}
```

#### Response

```json
{
  "results": [
    {
      "id": "lesson-4-what-is-ros2",
      "title": "What is ROS 2?",
      "chapter": {
        "id": "chapter-03-ros2",
        "title": "ROS 2 â€“ The Robotic Nervous System"
      },
      "content": "ROS 2 (Robot Operating System 2) is a flexible framework for writing robot applications...",
      "score": 0.95,
      "url": "/docs/chapter-03-ros2/lesson-1-what-is-ros2"
    }
  ]
}
```

## Content Chunking API (for RAG)

### Get Content Chunks

**GET** `/chunks`

Retrieve content in chunks optimized for RAG processing.

#### Query Parameters

- `chapterId` (string, optional): Filter by chapter
- `lessonId` (string, optional): Filter by lesson
- `maxChunkSize` (integer, optional): Maximum size of each chunk (default: 500 words)

#### Response

```json
{
  "chunks": [
    {
      "id": "chunk-001",
      "content": "Physical AI refers to the field that combines artificial intelligence with physical systems...",
      "sourceLesson": "lesson-1-what-is-physical-ai",
      "sourceChapter": "chapter-01-introduction",
      "keywords": ["Physical AI", "embodied intelligence", "robotics"],
      "sectionHeading": "What is Physical AI?"
    }
  ]
}
```

## Error Handling

### Standard Error Response

```json
{
  "error": {
    "code": "RESOURCE_NOT_FOUND",
    "message": "The requested resource was not found",
    "details": "Chapter with ID 'chapter-99-advanced-topics' does not exist"
  }
}
```

### Common Error Codes

- `RESOURCE_NOT_FOUND`: Requested resource does not exist
- `INVALID_PARAMETER`: Request parameter is invalid
- `RATE_LIMIT_EXCEEDED`: Request rate limit has been exceeded
- `INTERNAL_ERROR`: An unexpected error occurred on the server

## Authentication

Most endpoints are publicly accessible since the textbook content should be available to all students. However, future personalization features may require authentication:

**Header**: `Authorization: Bearer {token}`

## Rate Limiting

To ensure fair access to the API:

- Unauthenticated requests: 100 requests per hour per IP
- Authenticated requests: 1000 requests per hour per user